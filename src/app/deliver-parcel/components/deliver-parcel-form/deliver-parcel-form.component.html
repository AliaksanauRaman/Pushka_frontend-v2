<form
  class="pu-form"
  [formGroup]="_deliverParcelForm"
  (ngSubmit)="handleDeliverParcelFormSubmit()"
>
  @if (_places(); as places) {
    <pu-place-field
      class="pu-form__field"
      [puLabel]="'fieldLabel.departurePlace' | translate"
      [puPlaceholder]="'fieldPlaceholder.departurePlace' | translate"
      [places]="places"
      formControlName="departurePlace"
    />

    <pu-field-errors
      class="pu-form__field-errors"
      [areErrorsVisible]="_deliverParcelForm.controls.departurePlace.touched"
      [errors]="_deliverParcelForm.controls.departurePlace.errors"
      [errorsMappings]="{
        required: 'fieldError.departurePlaceIsRequired' | translate
      }"
    />

    <pu-place-field
      class="pu-form__field"
      [puLabel]="'fieldLabel.destination' | translate"
      [puPlaceholder]="'fieldPlaceholder.destination' | translate"
      [places]="places"
      formControlName="destination"
    />

    <pu-field-errors
      class="pu-form__field-errors"
      [areErrorsVisible]="_deliverParcelForm.controls.destination.touched"
      [errors]="_deliverParcelForm.controls.destination.errors"
      [errorsMappings]="{
        required: 'fieldError.destinationIsRequired' | translate
      }"
    />
  }

  <!-- TODO: Wording -->
  <pu-date-range-field
    class="pu-form__field"
    [puLabel]="'fieldLabel.validityPeriod' | translate"
    [puStartDatePlaceholder]="
      'fieldPlaceholder.validityPeriodStartDate' | translate
    "
    [puEndDatePlaceholder]="
      'fieldPlaceholder.validityPeriodEndDate' | translate
    "
    formControlName="validityPeriod"
  />

  <pu-field-errors
    class="pu-form__field-errors"
    [areErrorsVisible]="_deliverParcelForm.controls.validityPeriod.touched"
    [errors]="_deliverParcelForm.controls.validityPeriod.errors"
    [errorsMappings]="{
      startDateRequired:
        'fieldError.validityPeriodStartDateIsRequired' | translate,
      endDateRequired: 'fieldError.validityPeriodEndDateIsRequired' | translate
    }"
  />

  <pu-textarea-field
    class="pu-form__field"
    [puLabel]="'fieldLabel.description' | translate"
    [puPlaceholder]="'fieldPlaceholder.description' | translate"
    [puMaxLength]="_config.descriptionMaxLength"
    formControlName="description"
  />

  <pu-field-errors
    class="pu-form__field-errors"
    [areErrorsVisible]="_deliverParcelForm.controls.description.touched"
    [errors]="_deliverParcelForm.controls.description.errors"
    [errorsMappings]="{
      required: 'fieldError.descriptionIsRequired' | translate
    }"
  />

  <pu-text-field
    class="pu-form__field"
    [puLabel]="'fieldLabel.fullName' | translate"
    [puPlaceholder]="'fieldPlaceholder.fullName' | translate"
    [puMaxLength]="_config.fullNameMaxLength"
    formControlName="fullName"
  />

  <pu-field-errors
    class="pu-form__field-errors"
    [areErrorsVisible]="_deliverParcelForm.controls.fullName.touched"
    [errors]="_deliverParcelForm.controls.fullName.errors"
    [errorsMappings]="{
      required: 'fieldError.fullNameIsRequired' | translate
    }"
  />

  <pu-email-field
    class="pu-form__field"
    [puLabel]="'fieldLabel.email' | translate"
    [puPlaceholder]="'fieldPlaceholder.email' | translate"
    [puMaxLength]="_config.emailMaxLength"
    formControlName="email"
  />

  <pu-field-errors
    class="pu-form__field-errors"
    [areErrorsVisible]="_deliverParcelForm.controls.email.touched"
    [errors]="_deliverParcelForm.controls.email.errors"
    [errorsMappings]="{
      required: 'fieldError.emailIsRequired' | translate,
      emailFormat: 'fieldError.incorrectEmailFormat' | translate
    }"
  />

  <pu-phone-field
    class="pu-form__field"
    [puLabel]="'fieldLabel.notRequiredPhone' | translate"
    [puCountryCodePlaceholder]="'fieldPlaceholder.countryCode' | translate"
    [puNumberPlaceholder]="'fieldPlaceholder.phoneNumber' | translate"
    formControlName="phone"
  />

  <pu-field-errors
    class="pu-form__field-errors"
    [areErrorsVisible]="_deliverParcelForm.controls.phone.touched"
    [errors]="_deliverParcelForm.controls.phone.errors"
    [errorsMappings]="{
      countryCodeRequired: 'fieldError.countryCodeIsMissing' | translate,
      phoneNumberRequired: 'fieldError.phoneNumberIsMissing' | translate,
      phoneNumberFormat: 'fieldError.incorrectPhoneNumberFormat' | translate
    }"
  />

  <pu-checkbox-field
    class="pu-form__field"
    [puLabel]="'allowedItemsConfirmationText' | translate"
    formControlName="allowedItemsConfirmation"
  />

  <div class="checkboxes-spacer"></div>

  <pu-checkbox-field
    class="pu-form__field"
    [puLabel]="'noServiceResponsibilityConfirmationText' | translate"
    formControlName="noServiceResponsibilityConfirmation"
  />

  <button
    class="pu-form__submit-button"
    puAccentButton
    [isLoading]="_isLoading()"
    [disabled]="_isLoading() || _deliverParcelForm.invalid"
    type="submit"
  >
    <span>{{ "actionLabel.createApplication" | translate }}</span>
  </button>
</form>
